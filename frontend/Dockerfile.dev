# FROM node:18-alpine
# WORKDIR /app
# COPY package*.json ./
# RUN npm install
# COPY . .
# CMD ["npm", "run", "dev"]

# # ğŸ“¦ 1ë‹¨ê³„: Vue ì•± ë¹Œë“œ
# FROM node:18-alpine AS build
# WORKDIR /app
# COPY . .
# RUN npm install && npm run build

# # ğŸŒ 2ë‹¨ê³„: Nginxë¥¼ ì´ìš©í•œ ì„œë¹™
# FROM nginx:alpine

# # Nginx ì„¤ì • í…œí”Œë¦¿ ë³µì‚¬
# COPY ./nginx/default.conf.dev.template /etc/nginx/templates/default.conf.template

# # ë¹Œë“œëœ ì •ì  íŒŒì¼ ë³µì‚¬
# COPY --from=build /app/dist /usr/share/nginx/html

# 1ë‹¨ê³„: Vue ë¹Œë“œ
FROM node:18-alpine AS build
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build          # dist/

# 2ë‹¨ê³„: Nginxë¡œ ì •ì Â·API í”„ë¡ì‹œ + TLS ì¢…ë‹¨
FROM nginx:1.25-alpine

# ì¸ì¦ì„œ ë³¼ë¥¨ ë§ˆìš´íŠ¸ ìœ„ì¹˜ì™€ ê²½ë¡œ ë§ì¶°ì•¼ í•¨
COPY ./nginx/default.conf.dev.template /etc/nginx/templates/default.conf.template
COPY --from=build /app/dist /usr/share/nginx/html
EXPOSE 80 443
CMD ["nginx", "-g", "daemon off;"]